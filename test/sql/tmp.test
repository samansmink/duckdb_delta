# name: test/sql/generated/tpcds.test_slow
# description: Test on some medium sized data
# group: [delta_generated]

require parquet

require delta

require httpfs

require aws

statement ok
create secret s1 (type s3, provider credential_chain);

statement ok
ATTACH 's3://test-bucket-ceiveran/delta_benchmarking/delta_rs_tpch_sf1_100_splits/lineitem/delta_lake' as lineitem_pin (TYPE delta, PIN_SNAPSHOT)

statement ok
ATTACH 's3://test-bucket-ceiveran/delta_benchmarking/delta_rs_tpch_sf1_100_splits/lineitem/delta_lake' as lineitem_no_pin (TYPE delta);

statement ok
select count(*) from delta_scan('s3://test-bucket-ceiveran/delta_benchmarking/delta_rs_tpch_sf1_100_splits/lineitem/delta_lake');

#statement ok
#select count(*) from lineitem_pin

#statement ok
#select count(*) from lineitem_no_pin